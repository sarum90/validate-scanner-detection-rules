name: 'Scanner CLI Detection Rule Validator'
description: 'Validates detection rules using the scanner-cli tool'
inputs:
  scanner_api_base:
    description: 'Scanner.dev API base URL'
    required: true
  scanner_api_key:
    description: 'Scanner.dev API key'
    required: true
  file_pattern:
    description: 'File pattern to match YAML files'
    required: false
    default: '**/*.yml'
runs:
  using: 'composite'
  steps:
    - name: Install scanner-cli
      shell: bash
      run: |
        pip install scanner-cli
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
    - name: Install dependencies
      shell: bash
      run: npm install
      working-directory: ${{ github.action_path }}
    - name: Run validation
      shell: bash
      run: node ${{ github.action_path }}/index-cli.js
      env:
        INPUT_SCANNER_API_BASE: ${{ inputs.scanner_api_base }}
        INPUT_SCANNER_API_KEY: ${{ inputs.scanner_api_key }}
        INPUT_FILE_PATTERN: ${{ inputs.file_pattern }}
branding:
  icon: 'file-text'
  color: 'blue'